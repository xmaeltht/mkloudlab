# Pod Security Standards Configuration
# This file defines security policies for all namespaces
# Note: ArgoCD namespace removed (migrated to Flux)
# Note: Default namespace removed (already exists, cannot be recreated)
---
# Keycloak Namespace - Privileged for Istio service mesh
# Note: Changed to privileged to allow Istio init container capabilities (NET_ADMIN, NET_RAW)
apiVersion: v1
kind: Namespace
metadata:
  name: keycloak
  labels:
    pod-security.kubernetes.io/enforce: privileged
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
    name: keycloak
---
# Monitoring Namespace - Restricted for observability
apiVersion: v1
kind:  - name: compute-quota
    namespace: observability
  labels:
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/war  - name: mem-limit-range
    namespace: observability
---
# Observability Namespace - Restricted for Alloy collectors
apiVersion: v1
kind: Namespace
metadata:
  name: observability
  labels:
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
    name: observability
---
# SonarQube Namespace - Restricted for code quality
apiVersion: v1
kind: Namespace
metadata:
  name: sonarqube
  labels:
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
    name: sonarqube
---
# Kyverno Namespace - Requires privileged access for policy enforcement
apiVersion: v1
kind: Namespace
metadata:
  name: kyverno
  labels:
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
    name: kyverno
---
# Cert-Manager Namespace - Requires privileged access for certificate management
apiVersion: v1
kind: Namespace
metadata:
  name: cert-manager
  labels:
    pod-security.kubernetes.io/enforce: baseline
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
    name: cert-manager
---
# Note: Default namespace not included - it already exists and cannot be recreated
# To apply security labels to default namespace, use: kubectl label namespace default pod-security.kubernetes.io/enforce=restricted --overwrite
